import { CodeSurfer, CodeSurferColumns, Step } from "code-surfer";
import t, { codeSurferTheme } from "./theme";
import { ArrowRight } from "./ArrowRight";
import { Centered } from "./Centered";
import { Chart } from "./Chart";
import { Col } from "./Col";
import { Container } from "./Container";
import { FullScreenImg } from "./FullScreenImg";
import { Img } from "./Img";
import { ProgressBar } from "./ProgressBar";
import { RoundedBox } from "./RoundedBox";
import { StepChart } from "./StepChart";
import { TitlePage } from "./TitlePage";
import { TwoCols } from "./TwoCols";
import { WhoAmI } from "./WhoAmI";
import elephant from "./assets/elephant.jpg";
import pingu from "./assets/pingu.jpg";
import ts2365 from "./assets/ts2365.png";
import "./styles.css";

export const theme = t;

<Head>
  <title>React Native for Android Devs</title>
</Head>

<Footer>

<ProgressBar />

</Footer>

<TitlePage />

---

<WhoAmI>

# Who am I

Michele Bonazza

<Steps>

- FullStack Dev at URBI.co
- Co-founder at SketchTogether.com
- Backend Dev turned FullStack
- Slacker at dist0rtion.com (that's a zero)
- 95.90.225.243

</Steps>

</WhoAmI>

<Notes>

Our main app is a mobility aggregator (car/scooter/bike sharing, but also public transport, taxis, and recently trains)

We recently rebuilt our main app from scratch in RN, it's in prod (on Android, soon on iOS)

:heart: for python, but lately have been working with Java, Kotlin on the BE, RN and React on the client

</Notes>

---

<Container>

# Who are you

<Steps>

Maybe an Android Developer

Maybe someone who knows about Android Development

Definitely someone who wants to know about React Native

</Steps>

</Container>

---

<Container>

# Why

<Steps>

- Most (or the loudest) RN devs come from React/JS
- native side seen as last resort (it isn't!)
- RN (and React) are very unopinionated
- Boy, do I have opinions

</Steps>

</Container>

<Notes>

RN stands for React Native

</Notes>

---

<Container>

# What

<TwoCols>
  
<Col>

1. Intro to React Native

2. Brief intro to React

3. A bit more about React Native

4. Typescript

</Col>

<Col>

5. RN Libraries and frameworks

6. React Native gotchas

7. React Native pros &amp; cons

</Col>

</TwoCols>

</Container>

<Notes>

Intros to RN and React are really brief, I want to focus on real-life development

Most intros have you setup a regular project, so let's skip that

</Notes>

---

<Container>

# React Native

<Steps>

- A framework to build <u>native</u> apps in React

- Android and iOS, but also web, TVs, Windows, and OSX ( <Img src={pingu} height={50} inline /> )

- Write once, wait for Gradle and Xcode to build forever 😬

- Declarative (vs Imperative)

</Steps>

</Container>

<Notes>

Linux => react-native-desktop-qt, but no big company behind it

:stuck_out_tongue: it does take a long time to build from scratch, but you don't do it that often

Declarative meaning that not only the components are specified declaratively (XML), but business logic, too.

</Notes>

---

<FullScreenImg src={elephant} attribution="Victor Zastolskiy" modified />

<Notes>

It's the GDG, of course everyone knows about Flutter

</Notes>

---

<Container>

# Flutter (and Xamarin, and Kotlin Native, and...)

<Steps>

Other cross-platform frameworks exist, each with their own merits

It _really_ depends on your team (do you know Dart? How big is your team? Will you have to hire? Can you easily hire React Devs?)

Fighting over frameworks is **fun** :tada: (you go ahead, though)

More on this later

</Steps>

</Container>

---

<Container>

# How does it work

<StepChart>

<RoundedBox>
  
<p>React<br />(JS)</p>

</RoundedBox>

<ArrowRight>JSON</ArrowRight>

<RoundedBox borderGradient={{ left: "#61dafb", right: "#43db86" }}>
  Bridge
</RoundedBox>

<ArrowRight color="#43db86">????</ArrowRight>

<RoundedBox borderColor="#43db86">Native Views</RoundedBox>

</StepChart>

</Container>

---

<Container>

# React

Note:

<Steps>

- if your team is large enough, _you might not need to learn it_ :shushing_face:

- if it's _very_ large, you might be better off without RN, though :thinking_face:

- it's good to know anyway!

</Steps>

</Container>

<Notes>

For solos, of course you need to know everything.

For small teams, it depends: a few native devs who know about bridging + React devs orchestrating?

For large teams, see AirBnB (but also, brownfield apps)

</Notes>

---

<CodeSurfer theme={codeSurferTheme}>

<!-- prettier-ignore-start -->
```jsx title="React" subtitle="* not displayed here: 250MB of node_modules"
import React from "react";

export const HelloSomeone = (props) => (
  <div>
    Hello, {props.who}!
  </div>
);
```

```jsx title="React"
import React from "react";
import { HelloSomeone } from "./HelloSomeone";

export const MyApp = () => (
  <HelloSomeone who="world" />
);
```
<!-- prettier-ignore-end -->

</CodeSurfer>

---

<Container>

# What is React anyway

<StepChart>

<RoundedBox>
  
JSX

</RoundedBox>

<ArrowRight>JS</ArrowRight>

<RoundedBox>Layout tree</RoundedBox>

<ArrowRight>????</ArrowRight>

<RoundedBox>Rendering target</RoundedBox>

</StepChart>

A diff engine for trees :deciduous_tree:

</Container>

<Notes>

You don't need to know any of this while developing a regular RN app!

???? => calls that depend on the actual platform

</Notes>

---

<CodeSurferColumns themes={[codeSurferTheme, codeSurferTheme]}>

<Step>

<!-- prettier-ignore-start -->
```jsx title="React (JS)"
import React from "react";


export const HelloSomeone = (props) => (
  <div>
    Hello, {props.who}!
  </div>
);
```

```jsx title="React Native"
import React from "react";
import { Text, View } from "react-native";

export const HelloSomeone = (props) => (
  <View>
    <Text>Hello, {props.who}!</Text>
  </View>
);
```
<!-- prettier-ignore-end -->

</Step>

<Step>

<!-- prettier-ignore-start -->
```jsx 5,7 title="React (JS)"
import React from "react";


export const HelloSomeone = (props) => (
  <div>
    Hello, {props.who}!
  </div>
);
```

```jsx 2,5,6[5:10,30:36],7 title="React Native"
import React from "react";
import { Text, View } from "react-native";

export const HelloSomeone = (props) => (
  <View>
    <Text>Hello, {props.who}!</Text>
  </View>
);
```
<!-- prettier-ignore-end -->

</Step>

</CodeSurferColumns>

---

<Container>

# React (in browsers)

<Chart>

<RoundedBox>
  
JSX

</RoundedBox>

<ArrowRight>JS</ArrowRight>

<RoundedBox>Virtual DOM</RoundedBox>

<ArrowRight>JS</ArrowRight>

<RoundedBox>DOM</RoundedBox>

</Chart>

</Container>

---

<Container>

# React Native

<Chart>

<RoundedBox>
  
JSX

</RoundedBox>

<ArrowRight>Bridge</ArrowRight>

<RoundedBox borderColor="#43db86">Shadow tree</RoundedBox>

<ArrowRight color="#43db86">Yoga</ArrowRight>

<RoundedBox borderColor="#43db86">Native Views</RoundedBox>

</Chart>

</Container>

<Notes>

The bridge is the same we've seen on the previous slides

Yoga is a cross-platform layout engine written in C that implements FlexBox

</Notes>

---

<Container>

# Under the hood:

<Centered>

:eyes:

</Centered>

<Notes>

MessageQueue.spy(true);

</Notes>

</Container>

---

<Container>

# More on this

<Centered fontSize="84px">

<a href="https://www.youtube.com/watch?v=8va9prUqjnA" target="_blank">
  Emil Sjölander - React Native, The Native Bits
</a>

</Centered>

</Container>

---

<Container>

# Typescript

<Steps>

- a _typed_ superset of JS that compiles to JS

- you can have JS coexist with TS: types are _optional_

- being an Android Dev, you know they really shouldn't be :face_with_monocle:

- it's very smart!

</Steps>

</Container>

<Notes>

Using TS is not needed, but it **will** make your life easier

Use strict is life

Combined with ES6, it reminds me of what Kotlin is to Java

</Notes>

---

<!-- prettier-ignore-start -->

<CodeSurfer theme={codeSurferTheme}>

```ts title="Structural typing"
interface Person {
  name: string;
}

interface Animal {
  name: string;
}
```

```ts 9,10 title="Structural typing"
interface Person {
  name: string;
}

interface Animal {
  name: string;
}

let me: Person = { name: "Michele", speak: () => 'hi!' };
const horseman: Animal = { name: "Bojack" };
```

```ts 9:12 title="Structural typing"
interface Person {
  name: string;
}

interface Animal {
  name: string;
}

let me: Person = { name: "Michele", speak: () => 'hi!' };
const horseman: Animal = { name: "Bojack" };

me = horseman; // 👍
```

```ts 1:8 title="Structural typing"
interface Person {
  name: string;
  speak: () => string;
}

interface Animal {
  name: string;
}

let me: Person = { name: "Michele", speak: () => 'hi!' };
const horseman: Animal = { name: "Bojack" };
```

```ts 10:13 title="Structural typing"
interface Person {
  name: string;
  speak: () => string;
}

interface Animal {
  name: string;
}

let me: Person = { name: "Michele", speak: () => 'hi!' };
const horseman: Animal = { name: "Bojack" };

me = horseman; // 👎
```

</CodeSurfer>

<!-- prettier-ignore-end -->

<Notes>

I'm not gonna teach you TS now, just a brief overview at what's in there for you that's not in other typed languages.

</Notes>

---

<!-- prettier-ignore-start -->

<CodeSurfer theme={codeSurferTheme}>

```ts title="Union Types"
interface Product {
  id: string | number;
  status: 'new' | 'ordered' | 'dispatched' | 'delivered';
}

const p: Product = { id: 'ED-209', status: 'new' };
```

```ts 2,7 title="Union Types"
interface Product {
  id: string | number;
  status: 'new' | 'ordered' | 'dispatched' | 'delivered';
}

const p: Product = { id: 'ED-209', status: 'new' };
p.id.length; // 👎
```

```diff 6[8:16]
```

```ts title="Union Types"
interface Product {
  id: string | number;
  status: 'new' | 'ordered' | 'dispatched' | 'delivered';
}

const p: Product = { id: 'ED-209', status: 'new' };
p.id.length; // 👎
console.log(p.id + '3'); // 👍 => 'ED-2093'
```

```ts 8:9 title="Union Types"
interface Product {
  id: string | number;
  status: 'new' | 'ordered' | 'dispatched' | 'delivered';
}

const p: Product = { id: 'ED-209', status: 'new' };
p.id.length; // 👎
console.log(p.id + '3'); // 👍 => 'ED-2093'
console.log(p.id + 3); // 👎 
```

</CodeSurfer>

<!-- prettier-ignore-end -->

---

<Container>

<div
  style={{
    width: "100%",
    height: 0,
    paddingBottom: "54%",
    position: "relative",
  }}
>
  <iframe
    src="https://giphy.com/embed/s239QJIh56sRW"
    width="100%"
    height="100%"
    style={{ position: "absolute" }}
    frameBorder="0"
    class="giphy-embed"
    allowFullScreen
  ></iframe>
</div>

</Container>

---

<Container>

# Strict types

<Steps>

<img src={ts2365} />

`p.id` is defined as `string | number`

```js
'1' + '2' => '12'
```

```js
1 + 2 => 3
```

</Steps>

</Container>

---

<!-- prettier-ignore-start -->

<CodeSurfer theme={codeSurferTheme}>

```ts title="Intersection types"
type PrintSum = (first: number, second: number) => void;

type PrintConcat = (first: string, second: string) => void;
```

```ts 1:6 title="Intersection types"
type PrintSum = (first: number, second: number) => void;

type PrintConcat = (first: string, second: string) => void;

const printPlus: PrintSum & PrintConcat =
  (first: number | string, second: number | string) => null;
```

```diff 5[18:39]
```

```diff 6[11:26,36:50]
```

```diff 1[18:30,33:46],3[21:33,36:49],6[11:26,36:50]
```

```ts 1:8 title="Intersection types"
type PrintSum = (first: number, second: number) => void;

type PrintConcat = (first: string, second: string) => void;

const printPlus: PrintSum & PrintConcat =
  (first: number | string, second: number | string) => null;

printPlus(1, 2); // 👍
```

```ts 1:9 title="Intersection types"
type PrintSum = (first: number, second: number) => void;

type PrintConcat = (first: string, second: string) => void;

const printPlus: PrintSum & PrintConcat =
  (first: number | string, second: number | string) => null;

printPlus(1, 2); // 👍
printPlus('a', 'b'); // 👍
```

```ts 1:10 title="Intersection types"
type PrintSum = (first: number, second: number) => void;

type PrintConcat = (first: string, second: string) => void;

const printPlus: PrintSum & PrintConcat =
  (first: number | string, second: number | string) => null;

printPlus(1, 2); // 👍
printPlus('a', 'b'); // 👍
printPlus(1, 'a'); // 👎
```

</CodeSurfer>

<!-- prettier-ignore-end -->

---

<!-- prettier-ignore-start -->

<CodeSurfer theme={codeSurferTheme}>

```ts title="Tuples"
type Product = [string, number, boolean];
```

```ts 1:3 title="Tuples"
type Product = [string, number, boolean];

const product: Product = ['ED-209', 42, true];
```

```ts 1:5 title="Tuples"
type Product = [string, number, boolean];

const product: Product = ['ED-209', 42, true];

const [id, progressiveId, delivered] = product;
```

```ts 1:9 title="Tuples"
type Product = [string, number, boolean];

const product: Product = ['ED-209', 42, true];

const [id, progressiveId, delivered] = product;

// id is a string
// progressiveId is a number
// delivered is a boolean
```
</CodeSurfer>

<!-- prettier-ignore-end -->

---

<Container>

# More on this

<Centered fontSize="64px">

<a href="https://www.youtube.com/watch?v=wD5WGkOEJRs" target="_blank">
  Busy TypeScript Developer’s Guide to Advanced TypeScript | Ted Neward
</a>

</Centered>

</Container>

---

# INTERSECTION TYPES f1 = (a: string, b: number), f2 = (a: number, b: string), f: f1 & f2 => f(2, 2) error

# TUPLES [string, number]
